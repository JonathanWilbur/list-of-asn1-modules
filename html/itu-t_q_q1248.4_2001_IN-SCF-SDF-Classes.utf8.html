<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.0//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Generated by Asnp, the ASN.1 pretty-printer of France Telecom R&D (http://asn1.elibel.tm.fr/tools/asnp/).">
<TITLE>IN-SCF-SDF-Classes (Q.1248.4:07/2001)</TITLE>
</HEAD>
<BODY  >
-- Module IN-SCF-SDF-Classes (Q.1248.4:07/2001)<br>
-- See also <a href="/ITU-T/recommendations/fl.aspx?id=5500" target="_top">ITU-T Q.1248.4 (07/2001)</a><br>
-- See also the <a href="index2.html" target="_top">index</a> of all ASN.1 assignments needed in this document<br><br>
<PRE>
<A NAME="IN-SCF-SDF-Classes"></A>IN-SCF-SDF-Classes {itu-t recommendation q 1248 modules(1)
  in-scf-sdf-classes(15) version1(0)} <FONT COLOR=#0000FF><B>DEFINITIONS</B></FONT> ::=
<FONT COLOR=#0000FF><B>BEGIN</B></FONT>

<FONT COLOR=#0000FF><B>IMPORTS</B></FONT>
  ds-UsefulDefinitions, scf-sdf-datatypes, id-mt-verifyCredentials,
    id-mt-conformCredentials, id-mt-provideTokens, id-mt-fillSecurityTokens,
    id-oc-securityUserInfo, id-oc-tokensStock
    <FONT COLOR=#0000FF><B>FROM</B></FONT> IN-object-identifiers {itu-t recommendation q 1248 modules(1)
      in-object-identifiers(0) version1(0)}
  informationFramework
    <FONT COLOR=#0000FF><B>FROM</B></FONT> UsefulDefinitions ds-UsefulDefinitions
  ATTRIBUTE, OBJECT-CLASS
    <FONT COLOR=#0000FF><B>FROM</B></FONT> InformationFramework informationFramework
  NPartsMessage{}, TwoPartMessage, securityFacilityId, secretKey,
    identifierList, bindLevelIfOK, currentList, failureCounter, lockSession,
    maxAttempts, stockId, stock{}, source, sizeOfRestocking
    <FONT COLOR=#0000FF><B>FROM</B></FONT> IN-SCF-SDF-datatypes scf-sdf-datatypes;

<A NAME="IN-SCF-SDF-Classes.METHOD"></A><FONT COLOR=#B22222><I>-- METHOD information object class specification 
</I></FONT>METHOD ::= <FONT COLOR=#9370DB><B>CLASS</B></FONT> {
  &amp;InputAttributes   <A HREF="../../../x/x501/1997-tc1/InformationFramework.html#InformationFramework.ATTRIBUTE" target="files">ATTRIBUTE</A> <FONT COLOR=#9370DB><B>OPTIONAL</B></FONT>,
  &amp;SpecificInput     <FONT COLOR=#9370DB><B>OPTIONAL</B></FONT>,
  &amp;OutputAttributes  <A HREF="../../../x/x501/1997-tc1/InformationFramework.html#InformationFramework.ATTRIBUTE" target="files">ATTRIBUTE</A> <FONT COLOR=#9370DB><B>OPTIONAL</B></FONT>,
  &amp;SpecificOutput    <FONT COLOR=#9370DB><B>OPTIONAL</B></FONT>,
  &amp;description       <FONT COLOR=#5F9EA0><B>IA5String</B></FONT> <FONT COLOR=#9370DB><B>OPTIONAL</B></FONT>,
  &amp;id                <FONT COLOR=#5F9EA0><B>OBJECT IDENTIFIER</B></FONT> <FONT COLOR=#9370DB><B>UNIQUE</B></FONT>
}
<FONT COLOR=#9370DB><B>WITH SYNTAX</B></FONT> {
  [INPUT ATTRIBUTES &amp;InputAttributes]
  [SPECIFIC-INPUT &amp;SpecificInput]
  [OUTPUT ATTRIBUTES &amp;OutputAttributes]
  [SPECIFIC-OUTPUT &amp;SpecificOutput]
  [BEHAVIOUR &amp;description]
  ID &amp;id
}

<A NAME="IN-SCF-SDF-Classes.verifyCredentials"></A><FONT COLOR=#B22222><I>-- The &amp;InputAttributes field identifies the attributes which may be submitted as input
</I></FONT><FONT COLOR=#B22222><I>-- to the method execution.
</I></FONT><FONT COLOR=#B22222><I>-- The &amp;OutputAttributes field identifies the attributes which may be returned as output
</I></FONT><FONT COLOR=#B22222><I>-- of the method execution.
</I></FONT><FONT COLOR=#B22222><I>-- The &amp;SpecificInput field provides that syntax of additional information
</I></FONT><FONT COLOR=#B22222><I>-- which may be used as input to the method execution.
</I></FONT><FONT COLOR=#B22222><I>-- The &amp;SpecificOutput field provides that syntax of additional information
</I></FONT><FONT COLOR=#B22222><I>-- which may be used as output to the method execution.
</I></FONT><FONT COLOR=#B22222><I>-- The &amp;id field uniquely identifies the method.
</I></FONT><FONT COLOR=#B22222><I>-- method 
</I></FONT>verifyCredentials <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A> ::= {
  SPECIFIC-INPUT   <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.TwoPartMessage" target="files">TwoPartMessage</A>
  <FONT COLOR=#B22222><I>-- see the definition of this type below
  </I></FONT>SPECIFIC-OUTPUT  <FONT COLOR=#5F9EA0><B>BOOLEAN</B></FONT><FONT COLOR=#B22222><I> -- to indicate the success of the verification</I></FONT>
  BEHAVIOUR
    "This method performs the following actions on the entry identified by the
execute argument, this entry would be of class genericSecurityUserInfo:
1) if maxattempts is present, verify that failureCounter is inferior to its value
2) read the value of identifierList attribute
(return bad format entry if failure)
3) if conformMethodIdentifier is NULL go to step 5)
4) run conformMethodIdentifier method on TwopartMessage provided as specific input
(return a badconformance error if the execution fails or if the result is false)
5) run the oneToOneAlgorithm on the messageData bit string to get an expected certificationCode bit string
6) return TRUE if the expected and provided certificationCode values matched,
7) otherwise if failureCounter is present, increment it
8) return FALSE
"
  ID               <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-mt-verifyCredentials" target="files">id-mt-verifyCredentials</A>
}

<A NAME="IN-SCF-SDF-Classes.conformCredentials"></A>conformCredentials <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A> ::= {
  SPECIFIC-INPUT   <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.TwoPartMessage" target="files">TwoPartMessage</A>
  <FONT COLOR=#B22222><I>-- see the definition of this type below
  </I></FONT>SPECIFIC-OUTPUT  <FONT COLOR=#5F9EA0><B>BOOLEAN</B></FONT><FONT COLOR=#B22222><I> -- to indicate the success of the verification</I></FONT>
  BEHAVIOUR
    "This method performs the following actions on the entry identified by the execute argument, this entry would be of class genericSecurityUserInfo:
-	verify with an embedded conformance algorithm that messageData value of TwoPartMessage is no replay (RAND is in the current time window and the associated RS is not in the list of the current time windows currentList).
-	add RAND to time windows list currentList.
-	return TRUE if no replay,
-	otherwise return FALSE
"
  ID               <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-mt-conformCredentials" target="files">id-mt-conformCredentials</A>
}

<A NAME="IN-SCF-SDF-Classes.provideTokens"></A>provideTokens <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A> ::= {
  SPECIFIC-INPUT
    <FONT COLOR=#B8860B><B>SEQUENCE</B></FONT> {numOfRequestedTokens  <FONT COLOR=#5F9EA0><B>INTEGER</B></FONT>,<FONT COLOR=#B22222><I> -- how many tokens are requested (NOfRT)</I></FONT>
              oidOfAttribute        <FONT COLOR=#5F9EA0><B>OBJECT IDENTIFIER</B></FONT>
  }<FONT COLOR=#B22222><I> -- oid of the attribute (tokens)</I></FONT>
  <FONT COLOR=#B22222><I>/*SPECIFIC-OUTPUT 	ATTRIBUTE --attribute selected as input (tokens)*/
  </I></FONT>BEHAVIOUR
    "This method performs the following actions on the entry (thisEntry would be a variable with the DN value of this entry) identified by the execute argument:
1) if the attribute sizeOfRestocking does not exist in the entry, define a variable MAXNT with a default value (e.g. 10) else MAXNT takes the value of the attribute sizeOfRestocking
2) verify that NofRT is inferior or egal to MAXNT
(return an execute error if NofRT value is superior to MAXNT)
3) read the attribute of the entry which has the selected oid and count the number of values (0 if empty) and put the result in a variable N
(return execute error if the attribute does not exist)
4) read the source attribute in the entry
(return execute error error if source does not exist)
5) if N is inferior to NOfRT and the DN of source indicates an entry of class or subclass tokenStock:
5a) bind anonymous with the DSA which contains the entry defined by the address field of source
5b) execute the method provideTokens on the entry with MAXNT as value of the specific-input
5c) if none error is returned, modify the tokens attribute by adding the resulted values
6) if N is inferior to NOfRT and the DN of source indicates an entry of class or subclass securityUserInformation
6a) execute the method defined by fillMethodIdentifier field value on the entry defined by the DN with MAXNT as specific input
6b) if none error is returned, modify the tokens attribute by adding the resulted values
7) read the tokens attribute
8) define a variable toBeReturned with NofRT values of tokens attribute and a variable toBeKept with remainder values
9) remove tokens attribute
10) modify tokens attribute by adding the toBeKept values
11) return the toBeReturned values
"
  ID              <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-mt-provideTokens" target="files">id-mt-provideTokens</A>
}

<A NAME="IN-SCF-SDF-Classes.fillSecurityTokens"></A>fillSecurityTokens{<FONT COLOR=#5F9EA0><B>INTEGER</B></FONT>:n} <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A> ::= {
  SPECIFIC-INPUT   <FONT COLOR=#5F9EA0><B>INTEGER</B></FONT><FONT COLOR=#B22222><I> -- X number of value to be computed</I></FONT>
  SPECIFIC-OUTPUT  <FONT COLOR=#B8860B><B>SEQUENCE</B></FONT> <FONT COLOR=#B8860B><B>OF</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.NPartsMessage" target="files">NPartsMessage</A>{<FONT COLOR=#666666><I>n</I></FONT>}
  BEHAVIOUR
    "This method performs the following actions on the entry identified by the execute argument, this entry shall be of object class (or subclass) genericSecurityUserInfo:
- read the secretKey attribute and Algorithms attribute
- repeat X times
		- fill the first BIT STRING field with a random value
		- apply cryptographic algorithms to compute
	 	the other  BIT STRING fields of the NPARTMESSAGE.
- return X NPartMessage values
"
  ID               <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-mt-fillSecurityTokens" target="files">id-mt-fillSecurityTokens</A>
}

<A NAME="IN-SCF-SDF-Classes.SupportedMethods"></A>SupportedMethods <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A> ::=
  {...}

<A NAME="IN-SCF-SDF-Classes.DITMethodUse"></A><FONT COLOR=#B22222><I>-- The SupportedMethods set contains all of the defined methods for the interface. Its exact contents are
</I></FONT><FONT COLOR=#B22222><I>-- a matter for local determination as it will depend on the service and network provider agreements
</I></FONT><FONT COLOR=#B22222><I>-- being supported.
</I></FONT><FONT COLOR=#B22222><I>-- A DIT METHOD Use is a specification provided by the subschema administrative authority to specify
</I></FONT><FONT COLOR=#B22222><I>-- the METHOD types that may be used on entries of a particular object-class.
</I></FONT>DITMethodUse ::= <FONT COLOR=#B8860B><B>SEQUENCE</B></FONT> {
  objectClass  <A HREF="#InformationFramework.OBJECT-CLASS" target="files">OBJECT-CLASS</A>.&amp;id,
  methods      <FONT COLOR=#666666><B>[1] </B></FONT> <FONT COLOR=#B8860B><B>SET</B></FONT> <FONT COLOR=#B8860B><B>OF</B></FONT> <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A>.&amp;id
}

<A NAME="IN-SCF-SDF-Classes.METHOD-USE-RULE"></A><FONT COLOR=#B22222><I>-- a) the objectClass component identifies the object-class to which the DIT METHOD Use applies;
</I></FONT><FONT COLOR=#B22222><I>-- b) the methods component specifies types that shall be associated with the object-class whenever
</I></FONT><FONT COLOR=#B22222><I>-- entries of that object-class are stored;
</I></FONT><FONT COLOR=#B22222><I>-- The DITMethodUse definition for a particular object-class also applies to any subclass which may be
</I></FONT><FONT COLOR=#B22222><I>-- subsequently defined.
</I></FONT><FONT COLOR=#B22222><I>-- The METHOD-USE-RULE information object class is provided to facilitate the documentation of the
</I></FONT><FONT COLOR=#B22222><I>--  DIT METHOD Use rules:
</I></FONT>METHOD-USE-RULE ::= <FONT COLOR=#9370DB><B>CLASS</B></FONT> {
  &amp;objectClassType  <A HREF="#InformationFramework.OBJECT-CLASS" target="files">OBJECT-CLASS</A>.&amp;id <FONT COLOR=#9370DB><B>UNIQUE</B></FONT>,
  &amp;Mandatory        <A HREF="#IN-SCF-SDF-Classes.METHOD" target="files">METHOD</A>
}<FONT COLOR=#9370DB><B>WITH SYNTAX</B></FONT> {OBJECT-CLASS TYPE &amp;objectClassType
              METHODS &amp;Mandatory
}

<A NAME="IN-SCF-SDF-Classes.securityUserInfoRule"></A><FONT COLOR=#B22222><I>-- The METHOD-USE-RULE definition for a particular object-class also applies to any subclass
</I></FONT><FONT COLOR=#B22222><I>-- which may be subsequently defined.
</I></FONT><FONT COLOR=#B22222><I>-- method-use-rule 
</I></FONT>securityUserInfoRule{<FONT COLOR=#5F9EA0><B>INTEGER</B></FONT>:n} <A HREF="#IN-SCF-SDF-Classes.METHOD-USE-RULE" target="files">METHOD-USE-RULE</A> ::= {
  <A HREF="../../../x/x501/1997-tc1/InformationFramework.html#InformationFramework.OBJECT-CLASS" target="files">OBJECT-CLASS</A> TYPE  <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-oc-securityUserInfo" target="files">id-oc-securityUserInfo</A>
  METHODS
    {<A HREF="#IN-SCF-SDF-Classes.verifyCredentials" target="files">verifyCredentials</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="#IN-SCF-SDF-Classes.fillSecurityTokens" target="files">fillSecurityTokens</A>{<FONT COLOR=#666666><I>n</I></FONT>} <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="#IN-SCF-SDF-Classes.conformCredentials" target="files">conformCredentials</A>}
}

<A NAME="IN-SCF-SDF-Classes.securityUserInfo"></A><FONT COLOR=#B22222><I>-- object class 
</I></FONT><FONT COLOR=#B22222><I>-- The following object class could be used to store the necessary information about the user security.
</I></FONT><FONT COLOR=#B22222><I>-- For each UPT user, an entry of the securityUserInfo object class may be created, subordinated to each
</I></FONT><FONT COLOR=#B22222><I>-- entry of class uptUser.
</I></FONT>securityUserInfo <A HREF="../../../x/x501/1997-tc1/InformationFramework.html#InformationFramework.OBJECT-CLASS" target="files">OBJECT-CLASS</A> ::= {
  MUST CONTAIN  {<A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.securityFacilityId" target="files">securityFacilityId</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.secretKey" target="files">secretKey</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.identifierList" target="files">identifierList</A>}
  MAY CONTAIN
    {<A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.bindLevelIfOK" target="files">bindLevelIfOK</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.currentList" target="files">currentList</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.failureCounter" target="files">failureCounter</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.lockSession" target="files">lockSession</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.maxAttempts" target="files">maxAttempts</A>}
  ID            <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-oc-securityUserInfo" target="files">id-oc-securityUserInfo</A>
}

<A NAME="IN-SCF-SDF-Classes.tokensStock"></A><FONT COLOR=#B22222><I>-- The object class SecurityUserInfo supports the method verifyCredentials
</I></FONT>tokensStock{<FONT COLOR=#5F9EA0><B>INTEGER</B></FONT>:n} <A HREF="../../../x/x501/1997-tc1/InformationFramework.html#InformationFramework.OBJECT-CLASS" target="files">OBJECT-CLASS</A> ::= {
  KIND          abstract
  MUST CONTAIN  {<A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.stockId" target="files">stockId</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.stock" target="files">stock</A>{<FONT COLOR=#666666><I>n</I></FONT>}}
  MAY CONTAIN   {<A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.source" target="files">source</A> <FONT COLOR=#228B22><B>|</B></FONT> <A HREF="IN-SCF-SDF-datatypes.html#IN-SCF-SDF-datatypes.sizeOfRestocking" target="files">sizeOfRestocking</A>}
  ID            <A HREF="../../q1248.1/2001/IN-object-identifiers.html#IN-object-identifiers.id-oc-tokensStock" target="files">id-oc-tokensStock</A>
}

<FONT COLOR=#B22222><I>-- This object class is used to represent a set of information that is common to all disposable tokens
</I></FONT><FONT COLOR=#B22222><I>-- (stock identifier, source, and size of the set). Disposable tokens could be, for example authentication
</I></FONT><FONT COLOR=#B22222><I>-- tokens pairs, triplets.
</I></FONT><FONT COLOR=#0000FF><B>END</B></FONT>
</PRE>
-- Generated by Asnp, the ASN.1 pretty-printer of France Telecom R&amp;D
</BODY></HTML>
